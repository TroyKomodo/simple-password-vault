<!DOCTYPE html>
<html lang="en">
<head>
    {{> head name=general.name page="Vault" }}
    <link href="css/vault.css" rel="stylesheet">
</head>
<body>
{{> navigation name=general.name page="Vault" logout=true }}
<div class="padding-to-nav center-container">
    <table class="responsive-width">
    <thead>
    <tr>
        <th colspan="1000" class="bottom-border">
            <div class="space-between-container">
                <form action="/vault" method="get">
                    <select name="id" onchange="this.form.submit();">
                        {{#each tables}}
                            <option value="{{this.id}}"
                                    {{#if this.selected}}selected{{/if}}>{{this.name}}</option>
                        {{/each}}
                    </select>
                </form>
                <form action="/edit" method="get">
                    {{#each tables}}
                        {{#if this.selected}}
                            <input type="hidden" name="id" value="{{this.id}}">
                        {{/if}}
                    {{/each}}
                    <input type="submit" value="Edit table">
                </form>
            </div>
        </th>
    </tr>
        {{#each tables}}
            {{#if this.selected}}
            <tr>
                <th>#</th>
                {{#each this.columns}}
                    <th>{{this}}</th>
                {{/each}}
            </tr>
            </thead>
                <tbody>
                {{#if this.rows}}
                    {{#each this.rows}}
                        <tr>
                            <td>{{@index}}</td>
                            {{#each this.data}}
                                <!--TODO: Add word wrapping with "word-wrap: break-word"-->
                                <td>{{this}}</td>
                            {{/each}}
                            <td>
                                <form action="/delete-data" method="post">
                                    <input type="hidden" name="table_id" value="{{../id}}">
                                    <input type="hidden" name="row_id" value="{{this.id}}">
                                    <input type="submit" value="Delete">
                                </form>
                            </td>
                        </tr>
                    {{/each}}
                {{/if}}
                <tr>
                    <form id="add-data-form" action="/add-data" method="post">
                        <input type="hidden" name="table_id" value="{{this.id}}">
                    </form>
                    <td></td>
                    {{#each this.columns}}
                        <td>
                            <input form="add-data-form" type="text" name="data.{{this}}" placeholder="{{this}}"
                                   required>
                        </td>
                    {{/each}}
                    <td><input form="add-data-form" type="submit" value="Add"></td>
                </tr>
                </tbody>
            {{/if}}
        {{/each}}
    </table>
</div>
{{> action-bar }}
</body>
</html>
